<section class="card">
  <header class="card-header">
    <h2>Addresses</h2>
    <div class="header-actions">
      <button type="button" class="ghost" routerLink="/addresses/new">New</button>
    </div>
  </header>

  @if (isLoading()) {
    <p class="muted">Loading...</p>
  }
  @if (error()) {
    <p class="error">{{ error() }}</p>
  }

  @if (addresses().length) {
    <table class="table">
      <thead>
        <tr>
          <th>Street</th>
          <th>City</th>
          <th>State</th>
          <th>Number</th>
          <th>Zip code</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        @for (address of addresses(); track address.id ?? address.zipCode) {
          <tr>
            <td>{{ address.street }}</td>
            <td>{{ address.city }}</td>
            <td>{{ address.state }}</td>
            <td>{{ address.number }}</td>
            <td>{{ address.zipCode }}</td>
            <td>
              <div class="table-actions">
                <button
                  type="button"
                  class="ghost"
                  [routerLink]="['/addresses', address.id, 'view']"
                >
                  View
                </button>
                <button
                  type="button"
                  class="ghost"
                  [routerLink]="['/addresses', address.id, 'edit']"
                >
                  Edit
                </button>
                <button
                  type="button"
                  class="danger"
                  (click)="delete(address.id)"
                  [disabled]="isDeleting(address.id)"
                >
                  Delete
                </button>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  } @else {
    <p class="table-empty">No addresses yet.</p>
  }

  @if (totalPages() >= 1) {
    <div class="pagination">
      @if (totalElements() > 0) {
        <span class="pagination-meta">
          Showing {{ rangeStart() }}-{{ rangeEnd() }} of {{ totalElements() }}
        </span>
      }
      <button type="button" class="ghost" (click)="previousPage()" [disabled]="pageIndex() === 0">
        Previous
      </button>
      <span>Page {{ pageIndex() + 1 }} of {{ totalPages() }}</span>
      <select
        class="pagination-select"
        [value]="pageSize()"
        (change)="updatePageSize($any($event.target).value)"
      >
        <option [value]="10">10</option>
        <option [value]="50">50</option>
        <option [value]="100">100</option>
      </select>
      <button
        type="button"
        class="ghost"
        (click)="nextPage()"
        [disabled]="pageIndex() + 1 >= totalPages()"
      >
        Next
      </button>
    </div>
  }
</section>

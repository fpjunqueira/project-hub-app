<section class="card">
  <header class="card-header">
    <h2>Project Details</h2>
    <button type="button" class="ghost" routerLink="/projects">Back to list</button>
  </header>

  <div class="form-block">
    <h3>Details</h3>
    <div class="form-row">
      <div class="field">
        <label for="project-name-view">Project name</label>
        <input
          id="project-name-view"
          name="projectName"
          placeholder="Project name"
          [value]="project()?.projectName ?? ''"
          disabled
        />
      </div>
      <button
        type="button"
        [routerLink]="['/projects', project()?.id, 'edit']"
        [disabled]="!project()"
      >
        Edit
      </button>
    </div>
  </div>

  <div class="form-block">
    <h3>Address</h3>
    @if (addressLoading()) {
      <p class="muted">Loading related data...</p>
    }
    @if (!addressLoading()) {
      <table class="table">
        <thead>
          <tr>
            <th>Street</th>
            <th>City</th>
            <th>State</th>
            <th>Number</th>
            <th>Zip code</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @if (address(); as projectAddress) {
            <tr>
              <td>{{ projectAddress.street }}</td>
              <td>{{ projectAddress.city }}</td>
              <td>{{ projectAddress.state }}</td>
              <td>{{ projectAddress.number }}</td>
              <td>{{ projectAddress.zipCode }}</td>
              <td>
                <button
                  type="button"
                  class="ghost"
                  [routerLink]="['/addresses', projectAddress.id, 'view']"
                >
                  View
                </button>
              </td>
            </tr>
          } @else {
            <tr>
              <td colspan="6" class="table-empty">No address assigned.</td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>

  <div class="form-block">
    <h3>Owners</h3>
    @if (ownersLoading()) {
      <p class="muted">Loading related data...</p>
    }
    @if (!ownersLoading()) {
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (owner of owners(); track owner.id ?? owner.email) {
            <tr>
              <td>{{ owner.name }}</td>
              <td>{{ owner.email }}</td>
              <td>
                <button type="button" class="ghost" [routerLink]="['/owners', owner.id, 'view']">
                  View
                </button>
              </td>
            </tr>
          }
          @if (owners().length === 0) {
            <tr>
              <td colspan="3" class="table-empty">No owners linked.</td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>

  <div class="form-block">
    <h3>Files</h3>
    @if (filesLoading()) {
      <p class="muted">Loading related data...</p>
    }
    @if (!filesLoading()) {
      <table class="table">
        <thead>
          <tr>
            <th>Filename</th>
            <th>Path</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (file of files(); track file.id ?? file.path) {
            <tr>
              <td>{{ file.filename }}</td>
              <td>{{ file.path }}</td>
              <td>
                <button type="button" class="ghost" [routerLink]="['/files', file.id, 'view']">
                  View
                </button>
              </td>
            </tr>
          }
          @if (files().length === 0) {
            <tr>
              <td colspan="3" class="table-empty">No files linked.</td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>

  @if (isLoading()) {
    <p class="muted">Loading...</p>
  }
  @if (error()) {
    <p class="error">{{ error() }}</p>
  }
</section>
